pipeline {
  agent none

  stages {
    stage("Test back end") {
      agent {
        dockerfile {
          filename "back-end/dockerfiles/ci/Dockerfile"
        }
      }

      steps {
        //sh "cd back-end && bin/ci"
        sh "cat /etc/os-release"
        sh "ls -la /var/lib/jenkins/workspace"
      }
    }

    stage("Test front end") {
      agent {
        dockerfile {
          filename "front-end/dockerfiles/ci/Dockerfile"
        }
      }

      steps {
        //sh "rm -f front-end/node_modules && ln -s /app/node_modules front-end/node_modules"
        //sh "cd front-end && bin/ci"
        sh "ls -la /var/lib/jenkins/workspace"
        sh "cat /etc/os-release"
      }
    }
  }
}
